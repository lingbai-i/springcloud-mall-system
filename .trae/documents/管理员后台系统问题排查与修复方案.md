## 当前定位摘要
- 申请列表404根因：网关对 `admin-service` 路由使用 `StripPrefix=2`，将 `/api/admin/...` 剥离为后端看到的 `/...`；而控制器仍声明 `@RequestMapping("/admin/merchants/applications")`，导致实际路由应为 `/merchants/applications` 却匹配不到，引发 404。
  - 证据：`backend/gateway-service/src/main/resources/application.yml`:91–93 路由配置；`backend/admin-service/src/main/java/com/mall/admin/controller/MerchantApplicationController.java:20` 类级映射。
- 前端请求路径无误：`axios` 基础 `baseURL: '/api'` 结合 `getApplicationList` 的 `url: '/admin/merchants/applications'`，经网关应被正确转发到 `admin-service`。
  - 证据：`frontend/src/utils/request.js:25–32`、`frontend/src/api/merchant.js:43–49`。
- 申请列表加载失败触发点：`applications.vue:599` 的 `catch` 捕获并输出 `console.error('加载申请列表失败', error)`；结合 404，属于后端路由不匹配所致。
  - 证据：`frontend/src/views/admin/merchants/applications.vue:576–604`。
- Swagger/UI：`merchant-service` 已接入 Knife4j/OpenAPI，且 `SecurityConfig` 放行文档端点；`sms-service` 使用 `springdoc` 明确启用。
  - 证据：`backend/merchant-service/pom.xml:75–80`、`backend/merchant-service/src/main/java/.../SecurityConfig.java:53–55`、`backend/sms-service/src/main/resources/application.yml:113–130`。
- 消息队列与数据库：RabbitMQ 与商家库(`mall_merchant`)配置正常；`MerchantApplication` JPA 映射在 `merchant-service`。
  - 证据：`docker-compose.yml:259–273`、`backend/order-service/src/main/java/.../RabbitMQConfig.java:21–101`、`backend/merchant-service/src/main/resources/application.yml:11–23`、`backend/merchant-service/src/main/java/.../MerchantApplication.java:18`。

## 诊断采集计划
- 完整网络请求日志（前端）：
  - 打开浏览器 DevTools → Network，抓取 `/api/admin/merchants/applications?page=1&size=20...` 的请求；导出为 `HAR` 用于存档。
  - 记录字段：完整 URL、方法、请求/响应头、状态码、响应体、时延。
- AxiosError 细粒度记录（前端）：
  - 现有位置：`frontend/src/utils/request.js:151–211` 在响应拦截 `error` 分支 `logger.error('Response error', error)`；`logger.js:78` 输出错误。
  - 采集字段：`error.config.url`、`error.config.method`、`error.response.status`、`error.response.headers`、`error.stack`。
- 后端服务状态：
  - 访问网关暴露的 Health：`GET http://localhost:8080/actuator/health` 与各服务：
    - `http://localhost:8080/api/admin/actuator/health`
    - `http://localhost:8080/api/merchants/actuator/health`
    - `http://localhost:8080/api/sms/actuator/health`
  - 校验返回 `status: UP`；记录时间戳与Profile。
- Swagger 文档/接口定义：
  - `merchant-service`：`http://localhost:8080/api/merchants/doc.html` 或 `http://localhost:8087/doc.html`。
  - `sms-service`：`http://localhost:8080/api/sms/swagger-ui.html` 或 `http://localhost:8083/swagger-ui.html`。
  - 导出接口定义 JSON：`/v3/api-docs`。
- 请求/响应周期数据（后端）：
  - 提升日志级别（已在 yml 配置 `com.mall.merchant: debug`）并抓取 `gateway-service`、`admin-service`、`merchant-service` 的入站/出站日志，关注 `X-Request-ID` 关联链路。

## 修复方案
- 路由修复（优先）：将 `admin-service` 控制器类级映射从 `@RequestMapping("/admin/merchants/applications")` 改为 `@RequestMapping("/merchants/applications")`，与网关 `StripPrefix=2` 之后的实际路径对齐。
  - 影响面：前端无需改动；Feign Client 不受影响；网关配置保持不变。
- 备选方案（如需保留 `/admin/...` 前缀）：
  - 选项A：将网关 `admin-service` 路由 `filters` 改为 `StripPrefix=1`，仅去掉 `/api`；保持服务内的 `/admin/merchants/applications`。
  - 选项B：新增兼容路由：`Path=/api/admin-service/**` 并 `StripPrefix=2`，同时在前端改用 `/admin-service/admin/merchants/applications`（不推荐，增加耦合）。
- Axios错误日志增强：在 `logger.error` 的调用处序列化并输出关键字段（URL、方法、状态、响应头、堆栈），便于后续定位。
- 应用列表API返回一致化：统一后端返回结构使用 `R<T>`（`code/message/data`），或确保自定义响应包含 `code`/`success` 任一以兼容前端适配器 `request.js`。

## 验证步骤
- 后端：重启 `gateway-service` 与 `admin-service`；通过 `GET /api/admin/merchants/applications?page=1&size=20` 验证返回 `200`，响应体字段包含 `records/total/current/pages`。
- 前端：在 `applications.vue` 页面加载时无 404/ AxiosError；列表渲染 `applications.value.length>0`；统计接口 `GET /api/admin/merchants/applications/stats` 正常。
- E2E：使用浏览器自动化采集加载过程并截图留档；验证分页与状态筛选交互正常。

## 需修改的文件（拟）
- `backend/admin-service/src/main/java/com/mall/admin/controller/MerchantApplicationController.java`（类级 `@RequestMapping` 前缀修正）。
- 如选择备选方案，调整：`backend/gateway-service/src/main/resources/application.yml`（路由 `StripPrefix` 或新增兼容路由）。
- 增强日志（可选）：`frontend/src/utils/request.js` 与 `frontend/src/utils/logger.js`（输出 AxiosError 细节，不影响功能）。

## 风险与回滚
- 风险：路由前缀调整可能影响同模块其他接口；需全量回归 `admin-service` 路由。
- 回滚：如出现问题，恢复原 `@RequestMapping` 或网关 `StripPrefix` 配置；前端无改动即可回退。