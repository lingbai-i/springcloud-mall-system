# 基于springcloude的在线商城数据字典

**生成时间**: 2025-10-29 20:07:27 (Asia/Shanghai)  
**作者**: @author lingbai  
**版本**: V1.0  
**项目**: 微服务电商系统

## 概述

本数据字典描述了微服务电商系统中所有数据库的表结构、字段定义、索引和约束信息。系统采用微服务架构，每个服务使用独立的数据库，确保数据隔离和服务自治。

## 数据库架构

### 数据库列表

| 数据库名称    | 服务名称         | 描述               | 端口 |
| ------------- | ---------------- | ------------------ | ---- |
| mall_gateway  | gateway-service  | 网关服务数据库     | 8081 |
| mall_auth     | auth-service     | 认证授权服务数据库 | 8083 |
| mall_user     | user-service     | 用户服务数据库     | 8082 |
| mall_product  | product-service  | 商品服务数据库     | 8084 |
| mall_cart     | cart-service     | 购物车服务数据库   | 8089 |
| mall_order    | order-service    | 订单服务数据库     | 8085 |
| mall_payment  | payment-service  | 支付服务数据库     | 8086 |
| mall_merchant | merchant-service | 商户服务数据库     | 8087 |
| mall_admin    | admin-service    | 管理服务数据库     | 8088 |
| nacos         | nacos            | 配置中心数据库     | -    |

---

## 1. 用户服务数据库 (mall_user)

### 1.1 users 表

**表描述**: 用户基本信息表，存储系统用户的核心数据

| 字段名      | 数据类型  | 长度 | 是否为空 | 默认值                      | 主键 | 外键 | 索引    | 描述                     |
| ----------- | --------- | ---- | -------- | --------------------------- | ---- | ---- | ------- | ------------------------ |
| id          | BIGINT    | -    | NOT NULL | AUTO_INCREMENT              | ✓    | -    | PRIMARY | 用户唯一标识 ID          |
| username    | VARCHAR   | 50   | NOT NULL | -                           | -    | -    | UNIQUE  | 用户名，登录凭证         |
| password    | VARCHAR   | 255  | NOT NULL | -                           | -    | -    | -       | 加密后的用户密码         |
| email       | VARCHAR   | 100  | NULL     | -                           | -    | -    | INDEX   | 用户邮箱地址             |
| phone       | VARCHAR   | 20   | NULL     | -                           | -    | -    | INDEX   | 用户手机号码             |
| avatar      | VARCHAR   | 255  | NULL     | -                           | -    | -    | -       | 用户头像 URL             |
| nickname    | VARCHAR   | 50   | NULL     | -                           | -    | -    | -       | 用户昵称                 |
| gender      | TINYINT   | -    | NULL     | 0                           | -    | -    | -       | 性别：0-未知，1-男，2-女 |
| birthday    | DATE      | -    | NULL     | -                           | -    | -    | -       | 用户生日                 |
| status      | TINYINT   | -    | NOT NULL | 1                           | -    | -    | INDEX   | 用户状态：0-禁用，1-启用 |
| create_time | TIMESTAMP | -    | NOT NULL | CURRENT_TIMESTAMP           | -    | -    | INDEX   | 创建时间                 |
| update_time | TIMESTAMP | -    | NOT NULL | CURRENT_TIMESTAMP ON UPDATE | -    | -    | -       | 更新时间                 |

**索引信息**:

- PRIMARY KEY: `id`
- UNIQUE KEY: `username`
- INDEX: `email`, `phone`, `status`, `create_time`

### 1.2 user_addresses 表

**表描述**: 用户收货地址表，存储用户的收货地址信息

| 字段名         | 数据类型  | 长度 | 是否为空 | 默认值                      | 主键 | 外键 | 索引    | 描述                     |
| -------------- | --------- | ---- | -------- | --------------------------- | ---- | ---- | ------- | ------------------------ |
| id             | BIGINT    | -    | NOT NULL | AUTO_INCREMENT              | ✓    | -    | PRIMARY | 地址唯一标识 ID          |
| user_id        | BIGINT    | -    | NOT NULL | -                           | -    | ✓    | INDEX   | 用户 ID，关联 users 表   |
| receiver_name  | VARCHAR   | 50   | NOT NULL | -                           | -    | -    | -       | 收货人姓名               |
| receiver_phone | VARCHAR   | 20   | NOT NULL | -                           | -    | -    | -       | 收货人电话               |
| province       | VARCHAR   | 50   | NOT NULL | -                           | -    | -    | -       | 省份                     |
| city           | VARCHAR   | 50   | NOT NULL | -                           | -    | -    | -       | 城市                     |
| district       | VARCHAR   | 50   | NOT NULL | -                           | -    | -    | -       | 区县                     |
| detail_address | VARCHAR   | 255  | NOT NULL | -                           | -    | -    | -       | 详细地址                 |
| postal_code    | VARCHAR   | 10   | NULL     | -                           | -    | -    | -       | 邮政编码                 |
| is_default     | TINYINT   | -    | NOT NULL | 0                           | -    | -    | INDEX   | 是否默认地址：0-否，1-是 |
| create_time    | TIMESTAMP | -    | NOT NULL | CURRENT_TIMESTAMP           | -    | -    | -       | 创建时间                 |
| update_time    | TIMESTAMP | -    | NOT NULL | CURRENT_TIMESTAMP ON UPDATE | -    | -    | -       | 更新时间                 |

**索引信息**:

- PRIMARY KEY: `id`
- INDEX: `user_id`, `is_default`
- FOREIGN KEY: `user_id` REFERENCES `users(id)`

---

## 2. 商品服务数据库 (mall_product)

### 2.1 categories 表

**表描述**: 商品分类表，存储商品的分类层级结构

| 字段名      | 数据类型  | 长度 | 是否为空 | 默认值                      | 主键 | 外键 | 索引    | 描述                             |
| ----------- | --------- | ---- | -------- | --------------------------- | ---- | ---- | ------- | -------------------------------- |
| id          | BIGINT    | -    | NOT NULL | AUTO_INCREMENT              | ✓    | -    | PRIMARY | 分类唯一标识 ID                  |
| name        | VARCHAR   | 100  | NOT NULL | -                           | -    | -    | INDEX   | 分类名称                         |
| parent_id   | BIGINT    | -    | NULL     | 0                           | -    | -    | INDEX   | 父分类 ID，0 表示顶级分类        |
| level       | TINYINT   | -    | NOT NULL | 1                           | -    | -    | INDEX   | 分类层级：1-一级，2-二级，3-三级 |
| sort_order  | INT       | -    | NOT NULL | 0                           | -    | -    | -       | 排序顺序                         |
| icon        | VARCHAR   | 255  | NULL     | -                           | -    | -    | -       | 分类图标 URL                     |
| description | TEXT      | -    | NULL     | -                           | -    | -    | -       | 分类描述                         |
| status      | TINYINT   | -    | NOT NULL | 1                           | -    | -    | INDEX   | 状态：0-禁用，1-启用             |
| create_time | TIMESTAMP | -    | NOT NULL | CURRENT_TIMESTAMP           | -    | -    | -       | 创建时间                         |
| update_time | TIMESTAMP | -    | NOT NULL | CURRENT_TIMESTAMP ON UPDATE | -    | -    | -       | 更新时间                         |

**索引信息**:

- PRIMARY KEY: `id`
- INDEX: `name`, `parent_id`, `level`, `status`

### 2.2 products 表

**表描述**: 商品基本信息表，存储商品的核心数据

| 字段名         | 数据类型  | 长度 | 是否为空 | 默认值                      | 主键 | 外键 | 索引    | 描述                        |
| -------------- | --------- | ---- | -------- | --------------------------- | ---- | ---- | ------- | --------------------------- |
| id             | BIGINT    | -    | NOT NULL | AUTO_INCREMENT              | ✓    | -    | PRIMARY | 商品唯一标识 ID             |
| name           | VARCHAR   | 255  | NOT NULL | -                           | -    | -    | INDEX   | 商品名称                    |
| category_id    | BIGINT    | -    | NOT NULL | -                           | -    | ✓    | INDEX   | 分类 ID，关联 categories 表 |
| brand          | VARCHAR   | 100  | NULL     | -                           | -    | -    | INDEX   | 商品品牌                    |
| price          | DECIMAL   | 10,2 | NOT NULL | -                           | -    | -    | INDEX   | 商品价格                    |
| original_price | DECIMAL   | 10,2 | NULL     | -                           | -    | -    | -       | 原价                        |
| stock          | INT       | -    | NOT NULL | 0                           | -    | -    | INDEX   | 库存数量                    |
| sales          | INT       | -    | NOT NULL | 0                           | -    | -    | INDEX   | 销量                        |
| main_image     | VARCHAR   | 255  | NULL     | -                           | -    | -    | -       | 主图 URL                    |
| images         | TEXT      | -    | NULL     | -                           | -    | -    | -       | 商品图片 JSON 数组          |
| description    | TEXT      | -    | NULL     | -                           | -    | -    | -       | 商品描述                    |
| specifications | TEXT      | -    | NULL     | -                           | -    | -    | -       | 商品规格 JSON               |
| weight         | DECIMAL   | 8,2  | NULL     | -                           | -    | -    | -       | 商品重量(kg)                |
| status         | TINYINT   | -    | NOT NULL | 1                           | -    | -    | INDEX   | 状态：0-下架，1-上架        |
| create_time    | TIMESTAMP | -    | NOT NULL | CURRENT_TIMESTAMP           | -    | -    | INDEX   | 创建时间                    |
| update_time    | TIMESTAMP | -    | NOT NULL | CURRENT_TIMESTAMP ON UPDATE | -    | -    | -       | 更新时间                    |

**索引信息**:

- PRIMARY KEY: `id`
- INDEX: `name`, `category_id`, `brand`, `price`, `stock`, `sales`, `status`, `create_time`
- FOREIGN KEY: `category_id` REFERENCES `categories(id)`

---

## 3. 订单服务数据库 (mall_order)

### 3.1 orders 表

**表描述**: 订单主表，存储订单的基本信息

| 字段名           | 数据类型  | 长度 | 是否为空 | 默认值                      | 主键 | 外键 | 索引    | 描述                                                       |
| ---------------- | --------- | ---- | -------- | --------------------------- | ---- | ---- | ------- | ---------------------------------------------------------- |
| id               | BIGINT    | -    | NOT NULL | AUTO_INCREMENT              | ✓    | -    | PRIMARY | 订单唯一标识 ID                                            |
| order_no         | VARCHAR   | 32   | NOT NULL | -                           | -    | -    | UNIQUE  | 订单编号                                                   |
| user_id          | BIGINT    | -    | NOT NULL | -                           | -    | -    | INDEX   | 用户 ID                                                    |
| total_amount     | DECIMAL   | 10,2 | NOT NULL | -                           | -    | -    | INDEX   | 订单总金额                                                 |
| payment_amount   | DECIMAL   | 10,2 | NOT NULL | -                           | -    | -    | -       | 实付金额                                                   |
| freight_amount   | DECIMAL   | 10,2 | NOT NULL | 0.00                        | -    | -    | -       | 运费                                                       |
| discount_amount  | DECIMAL   | 10,2 | NOT NULL | 0.00                        | -    | -    | -       | 优惠金额                                                   |
| payment_type     | TINYINT   | -    | NULL     | -                           | -    | -    | INDEX   | 支付方式：1-微信，2-支付宝，3-银行卡                       |
| status           | TINYINT   | -    | NOT NULL | 1                           | -    | -    | INDEX   | 订单状态：1-待付款，2-待发货，3-待收货，4-已完成，5-已取消 |
| receiver_name    | VARCHAR   | 50   | NOT NULL | -                           | -    | -    | -       | 收货人姓名                                                 |
| receiver_phone   | VARCHAR   | 20   | NOT NULL | -                           | -    | -    | -       | 收货人电话                                                 |
| receiver_address | VARCHAR   | 500  | NOT NULL | -                           | -    | -    | -       | 收货地址                                                   |
| remark           | VARCHAR   | 500  | NULL     | -                           | -    | -    | -       | 订单备注                                                   |
| payment_time     | TIMESTAMP | -    | NULL     | -                           | -    | -    | INDEX   | 支付时间                                                   |
| delivery_time    | TIMESTAMP | -    | NULL     | -                           | -    | -    | -       | 发货时间                                                   |
| receive_time     | TIMESTAMP | -    | NULL     | -                           | -    | -    | -       | 收货时间                                                   |
| create_time      | TIMESTAMP | -    | NOT NULL | CURRENT_TIMESTAMP           | -    | -    | INDEX   | 创建时间                                                   |
| update_time      | TIMESTAMP | -    | NOT NULL | CURRENT_TIMESTAMP ON UPDATE | -    | -    | -       | 更新时间                                                   |

**索引信息**:

- PRIMARY KEY: `id`
- UNIQUE KEY: `order_no`
- INDEX: `user_id`, `total_amount`, `payment_type`, `status`, `payment_time`, `create_time`

### 3.2 order_items 表

**表描述**: 订单商品明细表，存储订单中的商品详情

| 字段名         | 数据类型  | 长度 | 是否为空 | 默认值                      | 主键 | 外键 | 索引    | 描述                    |
| -------------- | --------- | ---- | -------- | --------------------------- | ---- | ---- | ------- | ----------------------- |
| id             | BIGINT    | -    | NOT NULL | AUTO_INCREMENT              | ✓    | -    | PRIMARY | 明细唯一标识 ID         |
| order_id       | BIGINT    | -    | NOT NULL | -                           | -    | ✓    | INDEX   | 订单 ID，关联 orders 表 |
| product_id     | BIGINT    | -    | NOT NULL | -                           | -    | -    | INDEX   | 商品 ID                 |
| product_name   | VARCHAR   | 255  | NOT NULL | -                           | -    | -    | -       | 商品名称                |
| product_image  | VARCHAR   | 255  | NULL     | -                           | -    | -    | -       | 商品图片                |
| price          | DECIMAL   | 10,2 | NOT NULL | -                           | -    | -    | -       | 商品单价                |
| quantity       | INT       | -    | NOT NULL | -                           | -    | -    | -       | 购买数量                |
| total_price    | DECIMAL   | 10,2 | NOT NULL | -                           | -    | -    | -       | 小计金额                |
| specifications | VARCHAR   | 500  | NULL     | -                           | -    | -    | -       | 商品规格                |
| create_time    | TIMESTAMP | -    | NOT NULL | CURRENT_TIMESTAMP           | -    | -    | -       | 创建时间                |
| update_time    | TIMESTAMP | -    | NOT NULL | CURRENT_TIMESTAMP ON UPDATE | -    | -    | -       | 更新时间                |

**索引信息**:

- PRIMARY KEY: `id`
- INDEX: `order_id`, `product_id`
- FOREIGN KEY: `order_id` REFERENCES `orders(id)`

---

## 4. 购物车服务数据库 (mall_cart)

### 4.1 cart_items 表

**表描述**: 购物车商品表，存储用户购物车中的商品信息

| 字段名      | 数据类型  | 长度 | 是否为空 | 默认值                      | 主键 | 外键 | 索引    | 描述                 |
| ----------- | --------- | ---- | -------- | --------------------------- | ---- | ---- | ------- | -------------------- |
| id          | BIGINT    | -    | NOT NULL | AUTO_INCREMENT              | ✓    | -    | PRIMARY | 购物车项唯一标识 ID  |
| user_id     | BIGINT    | -    | NOT NULL | -                           | -    | -    | INDEX   | 用户 ID              |
| product_id  | BIGINT    | -    | NOT NULL | -                           | -    | -    | INDEX   | 商品 ID              |
| quantity    | INT       | -    | NOT NULL | 1                           | -    | -    | -       | 商品数量             |
| selected    | TINYINT   | -    | NOT NULL | 1                           | -    | -    | -       | 是否选中：0-否，1-是 |
| create_time | TIMESTAMP | -    | NOT NULL | CURRENT_TIMESTAMP           | -    | -    | INDEX   | 创建时间             |
| update_time | TIMESTAMP | -    | NOT NULL | CURRENT_TIMESTAMP ON UPDATE | -    | -    | -       | 更新时间             |

**索引信息**:

- PRIMARY KEY: `id`
- INDEX: `user_id`, `product_id`, `create_time`
- UNIQUE KEY: `user_id`, `product_id` (复合唯一索引)

---

## 5. 商户服务数据库 (mall_merchant)

### 5.1 merchants 表

**表描述**: 商户基本信息表

| 字段名           | 数据类型  | 长度 | 是否为空 | 默认值                      | 主键 | 外键 | 索引    | 描述                 |
| ---------------- | --------- | ---- | -------- | --------------------------- | ---- | ---- | ------- | -------------------- |
| id               | BIGINT    | -    | NOT NULL | AUTO_INCREMENT              | ✓    | -    | PRIMARY | 商户唯一标识 ID      |
| name             | VARCHAR   | 100  | NOT NULL | -                           | -    | -    | INDEX   | 商户名称             |
| code             | VARCHAR   | 50   | NOT NULL | -                           | -    | -    | UNIQUE  | 商户编码             |
| contact_person   | VARCHAR   | 50   | NOT NULL | -                           | -    | -    | -       | 联系人               |
| contact_phone    | VARCHAR   | 20   | NOT NULL | -                           | -    | -    | INDEX   | 联系电话             |
| email            | VARCHAR   | 100  | NULL     | -                           | -    | -    | -       | 邮箱地址             |
| address          | VARCHAR   | 255  | NULL     | -                           | -    | -    | -       | 商户地址             |
| business_license | VARCHAR   | 255  | NULL     | -                           | -    | -    | -       | 营业执照             |
| status           | TINYINT   | -    | NOT NULL | 1                           | -    | -    | INDEX   | 状态：0-禁用，1-启用 |
| create_time      | TIMESTAMP | -    | NOT NULL | CURRENT_TIMESTAMP           | -    | -    | -       | 创建时间             |
| update_time      | TIMESTAMP | -    | NOT NULL | CURRENT_TIMESTAMP ON UPDATE | -    | -    | -       | 更新时间             |

**索引信息**:

- PRIMARY KEY: `id`
- UNIQUE KEY: `code`
- INDEX: `name`, `contact_phone`, `status`

### 5.2 stores 表

**表描述**: 门店信息表

| 字段名         | 数据类型  | 长度 | 是否为空 | 默认值                      | 主键 | 外键 | 索引    | 描述                       |
| -------------- | --------- | ---- | -------- | --------------------------- | ---- | ---- | ------- | -------------------------- |
| id             | BIGINT    | -    | NOT NULL | AUTO_INCREMENT              | ✓    | -    | PRIMARY | 门店唯一标识 ID            |
| merchant_id    | BIGINT    | -    | NOT NULL | -                           | -    | ✓    | INDEX   | 商户 ID，关联 merchants 表 |
| name           | VARCHAR   | 100  | NOT NULL | -                           | -    | -    | INDEX   | 门店名称                   |
| code           | VARCHAR   | 50   | NOT NULL | -                           | -    | -    | UNIQUE  | 门店编码                   |
| manager        | VARCHAR   | 50   | NOT NULL | -                           | -    | -    | -       | 店长姓名                   |
| phone          | VARCHAR   | 20   | NOT NULL | -                           | -    | -    | -       | 门店电话                   |
| address        | VARCHAR   | 255  | NOT NULL | -                           | -    | -    | -       | 门店地址                   |
| longitude      | DECIMAL   | 10,6 | NULL     | -                           | -    | -    | -       | 经度                       |
| latitude       | DECIMAL   | 10,6 | NULL     | -                           | -    | -    | -       | 纬度                       |
| business_hours | VARCHAR   | 100  | NULL     | -                           | -    | -    | -       | 营业时间                   |
| status         | TINYINT   | -    | NOT NULL | 1                           | -    | -    | INDEX   | 状态：0-关闭，1-营业       |
| create_time    | TIMESTAMP | -    | NOT NULL | CURRENT_TIMESTAMP           | -    | -    | -       | 创建时间                   |
| update_time    | TIMESTAMP | -    | NOT NULL | CURRENT_TIMESTAMP ON UPDATE | -    | -    | -       | 更新时间                   |

**索引信息**:

- PRIMARY KEY: `id`
- UNIQUE KEY: `code`
- INDEX: `merchant_id`, `name`, `status`
- FOREIGN KEY: `merchant_id` REFERENCES `merchants(id)`

---

## 6. 支付服务数据库 (mall_payment)

### 6.1 payment_records 表

**表描述**: 支付记录表，存储所有支付交易记录

| 字段名          | 数据类型  | 长度 | 是否为空 | 默认值                      | 主键 | 外键 | 索引    | 描述                                                 |
| --------------- | --------- | ---- | -------- | --------------------------- | ---- | ---- | ------- | ---------------------------------------------------- |
| id              | BIGINT    | -    | NOT NULL | AUTO_INCREMENT              | ✓    | -    | PRIMARY | 支付记录唯一标识 ID                                  |
| payment_no      | VARCHAR   | 32   | NOT NULL | -                           | -    | -    | UNIQUE  | 支付流水号                                           |
| order_no        | VARCHAR   | 32   | NOT NULL | -                           | -    | -    | INDEX   | 订单编号                                             |
| user_id         | BIGINT    | -    | NOT NULL | -                           | -    | -    | INDEX   | 用户 ID                                              |
| amount          | DECIMAL   | 10,2 | NOT NULL | -                           | -    | -    | INDEX   | 支付金额                                             |
| payment_type    | TINYINT   | -    | NOT NULL | -                           | -    | -    | INDEX   | 支付方式：1-微信，2-支付宝，3-银行卡                 |
| payment_channel | VARCHAR   | 50   | NOT NULL | -                           | -    | -    | -       | 支付渠道                                             |
| third_party_no  | VARCHAR   | 64   | NULL     | -                           | -    | -    | INDEX   | 第三方支付流水号                                     |
| status          | TINYINT   | -    | NOT NULL | 1                           | -    | -    | INDEX   | 支付状态：1-待支付，2-支付成功，3-支付失败，4-已退款 |
| callback_info   | TEXT      | -    | NULL     | -                           | -    | -    | -       | 回调信息                                             |
| remark          | VARCHAR   | 255  | NULL     | -                           | -    | -    | -       | 备注                                                 |
| payment_time    | TIMESTAMP | -    | NULL     | -                           | -    | -    | INDEX   | 支付完成时间                                         |
| create_time     | TIMESTAMP | -    | NOT NULL | CURRENT_TIMESTAMP           | -    | -    | INDEX   | 创建时间                                             |
| update_time     | TIMESTAMP | -    | NOT NULL | CURRENT_TIMESTAMP ON UPDATE | -    | -    | -       | 更新时间                                             |

**索引信息**:

- PRIMARY KEY: `id`
- UNIQUE KEY: `payment_no`
- INDEX: `order_no`, `user_id`, `amount`, `payment_type`, `third_party_no`, `status`, `payment_time`, `create_time`

---

## 7. 管理服务数据库 (mall_admin)

### 7.1 admin_users 表

**表描述**: 管理员用户表

| 字段名          | 数据类型  | 长度 | 是否为空 | 默认值                      | 主键 | 外键 | 索引    | 描述                                |
| --------------- | --------- | ---- | -------- | --------------------------- | ---- | ---- | ------- | ----------------------------------- |
| id              | BIGINT    | -    | NOT NULL | AUTO_INCREMENT              | ✓    | -    | PRIMARY | 管理员唯一标识 ID                   |
| username        | VARCHAR   | 50   | NOT NULL | -                           | -    | -    | UNIQUE  | 管理员用户名                        |
| password        | VARCHAR   | 255  | NOT NULL | -                           | -    | -    | -       | 加密后的密码                        |
| real_name       | VARCHAR   | 50   | NOT NULL | -                           | -    | -    | -       | 真实姓名                            |
| email           | VARCHAR   | 100  | NULL     | -                           | -    | -    | -       | 邮箱地址                            |
| phone           | VARCHAR   | 20   | NULL     | -                           | -    | -    | -       | 手机号码                            |
| avatar          | VARCHAR   | 255  | NULL     | -                           | -    | -    | -       | 头像 URL                            |
| role            | VARCHAR   | 50   | NOT NULL | 'admin'                     | -    | -    | INDEX   | 角色：admin-管理员，operator-操作员 |
| status          | TINYINT   | -    | NOT NULL | 1                           | -    | -    | INDEX   | 状态：0-禁用，1-启用                |
| last_login_time | TIMESTAMP | -    | NULL     | -                           | -    | -    | -       | 最后登录时间                        |
| last_login_ip   | VARCHAR   | 50   | NULL     | -                           | -    | -    | -       | 最后登录 IP                         |
| create_time     | TIMESTAMP | -    | NOT NULL | CURRENT_TIMESTAMP           | -    | -    | -       | 创建时间                            |
| update_time     | TIMESTAMP | -    | NOT NULL | CURRENT_TIMESTAMP ON UPDATE | -    | -    | -       | 更新时间                            |

**索引信息**:

- PRIMARY KEY: `id`
- UNIQUE KEY: `username`
- INDEX: `role`, `status`

---

## 8. 认证服务数据库 (mall_auth)

### 8.1 oauth_tokens 表

**表描述**: OAuth 令牌表，存储访问令牌和刷新令牌

| 字段名        | 数据类型  | 长度 | 是否为空 | 默认值            | 主键 | 外键 | 索引    | 描述                |
| ------------- | --------- | ---- | -------- | ----------------- | ---- | ---- | ------- | ------------------- |
| id            | BIGINT    | -    | NOT NULL | AUTO_INCREMENT    | ✓    | -    | PRIMARY | 令牌记录唯一标识 ID |
| access_token  | VARCHAR   | 255  | NOT NULL | -                 | -    | -    | UNIQUE  | 访问令牌            |
| refresh_token | VARCHAR   | 255  | NULL     | -                 | -    | -    | INDEX   | 刷新令牌            |
| user_id       | BIGINT    | -    | NOT NULL | -                 | -    | -    | INDEX   | 用户 ID             |
| client_id     | VARCHAR   | 50   | NOT NULL | -                 | -    | -    | INDEX   | 客户端 ID           |
| scope         | VARCHAR   | 255  | NULL     | -                 | -    | -    | -       | 授权范围            |
| token_type    | VARCHAR   | 20   | NOT NULL | 'Bearer'          | -    | -    | -       | 令牌类型            |
| expires_in    | INT       | -    | NOT NULL | 7200              | -    | -    | -       | 过期时间(秒)        |
| create_time   | TIMESTAMP | -    | NOT NULL | CURRENT_TIMESTAMP | -    | -    | INDEX   | 创建时间            |
| expire_time   | TIMESTAMP | -    | NOT NULL | -                 | -    | -    | INDEX   | 过期时间            |

**索引信息**:

- PRIMARY KEY: `id`
- UNIQUE KEY: `access_token`
- INDEX: `refresh_token`, `user_id`, `client_id`, `create_time`, `expire_time`

---

## 9. 网关服务数据库 (mall_gateway)

### 9.1 api_logs 表

**表描述**: API 访问日志表，记录所有通过网关的 API 请求

| 字段名          | 数据类型  | 长度 | 是否为空 | 默认值            | 主键 | 外键 | 索引    | 描述            |
| --------------- | --------- | ---- | -------- | ----------------- | ---- | ---- | ------- | --------------- |
| id              | BIGINT    | -    | NOT NULL | AUTO_INCREMENT    | ✓    | -    | PRIMARY | 日志唯一标识 ID |
| request_id      | VARCHAR   | 64   | NOT NULL | -                 | -    | -    | UNIQUE  | 请求唯一标识    |
| user_id         | BIGINT    | -    | NULL     | -                 | -    | -    | INDEX   | 用户 ID         |
| method          | VARCHAR   | 10   | NOT NULL | -                 | -    | -    | INDEX   | HTTP 方法       |
| url             | VARCHAR   | 500  | NOT NULL | -                 | -    | -    | INDEX   | 请求 URL        |
| ip              | VARCHAR   | 50   | NOT NULL | -                 | -    | -    | INDEX   | 客户端 IP       |
| user_agent      | VARCHAR   | 500  | NULL     | -                 | -    | -    | -       | 用户代理        |
| request_body    | TEXT      | -    | NULL     | -                 | -    | -    | -       | 请求体          |
| response_status | INT       | -    | NOT NULL | -                 | -    | -    | INDEX   | 响应状态码      |
| response_time   | INT       | -    | NOT NULL | -                 | -    | -    | INDEX   | 响应时间(ms)    |
| create_time     | TIMESTAMP | -    | NOT NULL | CURRENT_TIMESTAMP | -    | -    | INDEX   | 创建时间        |

**索引信息**:

- PRIMARY KEY: `id`
- UNIQUE KEY: `request_id`
- INDEX: `user_id`, `method`, `url`, `ip`, `response_status`, `response_time`, `create_time`

---

## 10. 公共字段说明

### 10.1 BaseEntity 公共字段

所有实体类都继承自 BaseEntity，包含以下公共字段：

| 字段名      | 数据类型  | 描述                   |
| ----------- | --------- | ---------------------- |
| id          | BIGINT    | 主键 ID，自增          |
| create_time | TIMESTAMP | 创建时间，默认当前时间 |
| update_time | TIMESTAMP | 更新时间，自动更新     |

### 10.2 状态字段枚举值

| 状态类型 | 枚举值 | 描述      |
| -------- | ------ | --------- |
| 通用状态 | 0      | 禁用/关闭 |
| 通用状态 | 1      | 启用/开启 |
| 订单状态 | 1      | 待付款    |
| 订单状态 | 2      | 待发货    |
| 订单状态 | 3      | 待收货    |
| 订单状态 | 4      | 已完成    |
| 订单状态 | 5      | 已取消    |
| 支付状态 | 1      | 待支付    |
| 支付状态 | 2      | 支付成功  |
| 支付状态 | 3      | 支付失败  |
| 支付状态 | 4      | 已退款    |

---

## 11. 数据库设计原则

### 11.1 命名规范

- 数据库名：采用 `mall_` 前缀 + 服务名
- 表名：使用复数形式，如 `users`、`products`
- 字段名：使用下划线分隔的小写字母，如 `user_id`、`create_time`
- 索引名：使用 `idx_` 前缀 + 表名 + 字段名

### 11.2 数据类型选择

- 主键：统一使用 `BIGINT` 自增
- 时间：使用 `TIMESTAMP` 类型
- 金额：使用 `DECIMAL(10,2)` 类型
- 状态：使用 `TINYINT` 类型
- 文本：根据长度选择 `VARCHAR` 或 `TEXT`

### 11.3 索引策略

- 主键自动创建聚簇索引
- 外键字段创建普通索引
- 经常查询的字段创建索引
- 复合查询创建复合索引
- 唯一性约束创建唯一索引

### 11.4 约束设计

- 主键约束：每张表必须有主键
- 外键约束：维护数据完整性
- 唯一约束：防止重复数据
- 非空约束：保证数据完整性
- 默认值：提供合理的默认值

---

## 12. 版本历史

| 版本 | 日期       | 作者            | 变更内容                   |
| ---- | ---------- | --------------- | -------------------------- |
| V1.0 | 2025-10-29 | @author lingbai | 初始版本，创建完整数据字典 |

---

**注意事项**:

1. 本数据字典基于当前系统设计，如有变更请及时更新
2. 所有时间字段均使用 Asia/Shanghai 时区
3. 金额字段统一使用分为单位存储，显示时转换为元
4. 删除操作建议使用逻辑删除，添加 `deleted` 字段标记
5. 敏感信息如密码必须加密存储，不得明文保存
