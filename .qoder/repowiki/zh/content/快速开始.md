# 快速开始

<cite>
**本文档引用的文件**  
- [README.md](file://README.md)
- [QUICK_START.md](file://QUICK_START.md)
- [DEVELOPMENT.md](file://DEVELOPMENT.md)
- [TROUBLESHOOTING.md](file://TROUBLESHOOTING.md)
- [docker-compose-dev.yml](file://docker-compose-dev.yml)
- [init.sql](file://sql/init.sql)
- [一键启动.bat](file://一键启动.bat)
- [快速启动.bat](file://快速启动.bat)
- [start-dev-silent.bat](file://start-dev-silent.bat)
- [start-dev.bat](file://start-dev.bat)
- [stop-dev-silent.bat](file://stop-dev-silent.bat)
- [check-services-silent.ps1](file://check-services-silent.ps1)
- [tail-logs.ps1](file://tail-logs.ps1)
- [restart-service.ps1](file://restart-service.ps1)
</cite>

## 目录
1. [开发环境准备](#开发环境准备)
2. [项目克隆与依赖安装](#项目克隆与依赖安装)
3. [数据库初始化](#数据库初始化)
4. [服务启动](#服务启动)
5. [访问与验证](#访问与验证)
6. [一键启动脚本使用](#一键启动脚本使用)
7. [常见问题排查](#常见问题排查)
8. [服务管理](#服务管理)

## 开发环境准备

在开始之前，请确保您的开发环境中已安装以下软件：

- **JDK**: 17 或更高版本（推荐 JDK 22）
- **Node.js**: 18 或更高版本
- **Maven**: 3.6 或更高版本
- **Docker**: 20 或更高版本，并安装 Docker Compose
- **MySQL**: 8.0 或更高版本（由 Docker 提供，无需单独安装）
- **Redis**: 6.0 或更高版本（由 Docker 提供，无需单独安装）

### 环境检查命令

您可以通过以下命令检查环境是否已正确安装：

```bash
java -version
node -v
npm -v
mvn -version
docker --version
docker-compose --version
```

**Section sources**
- [README.md](file://README.md#L114-L119)
- [QUICK_START.md](file://QUICK_START.md#L11-L15)

## 项目克隆与依赖安装

### 1. 克隆项目

打开命令行工具，执行以下命令克隆项目：

```bash
git clone <repository-url>
cd springcloud-mall
```

### 2. 安装后端依赖

项目后端使用 Maven 进行依赖管理。在项目根目录下，后端服务的依赖会在首次启动时自动下载。您也可以手动编译以确保依赖完整：

```bash
cd backend
mvn clean compile -DskipTests
```

### 3. 安装前端依赖

前端项目位于 `frontend` 目录，使用 npm 管理依赖。首次运行时需要安装依赖：

```bash
cd frontend
npm install
```

**Section sources**
- [README.md](file://README.md#L204-L208)
- [DEVELOPMENT.md](file://DEVELOPMENT.md#L30-L35)

## 数据库初始化

项目使用 Docker 启动 MySQL、Redis 和 Nacos 等基础设施。数据库初始化脚本 `sql/init.sql` 会自动创建所需的数据库和表结构。

### 执行数据库初始化

在项目根目录下，执行以下命令启动基础设施并初始化数据库：

```bash
docker-compose -f docker-compose-dev.yml up -d
```

此命令会启动以下容器：
- `mall-mysql-dev`: MySQL 8.0，端口映射为 `3307`
- `mall-redis-dev`: Redis 7，端口映射为 `6379`
- `mall-nacos-dev`: Nacos 2.3.0，端口映射为 `8848`

**Section sources**
- [README.md](file://README.md#L224-L228)
- [docker-compose-dev.yml](file://docker-compose-dev.yml#L7-L78)
- [init.sql](file://sql/init.sql#L1-L259)

## 服务启动

项目提供多种服务启动方式，推荐使用一键启动脚本。

### 方式一：一键启动（推荐）

项目提供多个批处理脚本，可一键启动所有服务。

#### 1. 智能后台启动（全自动）

此模式会自动启动所有服务，并在后台运行，无弹窗干扰，日志统一输出到 `logs/` 目录。

```bash
start-dev-silent.bat
```

#### 2. 交互式启动

此模式会提示您选择是否启动后端和前端服务。

```bash
start-dev.bat
```

#### 3. 调试模式启动

如果启动脚本闪退，建议使用调试模式启动，以查看详细的错误信息。

```bash
start-dev-debug.bat
```

### 方式二：手动启动

如果您需要在 IDE 中调试特定服务，可以手动启动。

#### 1. 启动基础设施

```bash
docker-compose -f docker-compose-dev.yml up -d
```

#### 2. 在 IDE 中启动微服务

推荐使用 IntelliJ IDEA 打开 `backend` 目录，然后依次运行以下主类：
- `GatewayServiceApplication` (端口 8080)
- `UserServiceApplication` (端口 8082)
- `ProductServiceApplication` (端口 8083)
- `CartServiceApplication` (端口 8088)

#### 3. 启动前端

```bash
cd frontend
npm run dev
```

**Section sources**
- [README.md](file://README.md#L134-L157)
- [QUICK_START.md](file://QUICK_START.md#L76-L129)
- [一键启动.bat](file://一键启动.bat#L1-L231)
- [快速启动.bat](file://快速启动.bat#L1-L143)
- [start-dev-silent.bat](file://start-dev-silent.bat#L1-L316)
- [start-dev.bat](file://start-dev.bat#L1-L154)

## 访问与验证

服务启动成功后，您可以访问以下地址：

| 服务 | 地址 | 说明 |
|------|------|------|
| 前端应用 | http://localhost:5173 | 用户界面 |
| API网关 | http://localhost:8080 | 统一API入口 |
| Nacos控制台 | http://localhost:8848/nacos | 服务注册中心 (账号: nacos, 密码: nacos) |
| MySQL | localhost:3307 | 数据库 (账号: root, 密码: 123456) |
| Redis | localhost:6379 | 缓存服务器 |

### 测试账号

系统已预置测试账号：

| 账号类型 | 用户名 | 密码 |
|---------|--------|------|
| 管理员 | `admin` | `nacos` |
| 测试用户 | `testlogin` | `nacos` |

**Section sources**
- [README.md](file://README.md#L265-L272)
- [QUICK_START.md](file://QUICK_START.md#L137-L144)

## 一键启动脚本使用

项目提供多个一键启动脚本，简化开发流程。

### 脚本列表

| 脚本名称 | 说明 |
|---------|------|
| `一键启动.bat` | 交互式启动，可选择启动后端和前端 |
| `快速启动.bat` | 快速启动基础设施和核心服务 |
| `start-dev-silent.bat` | 静默启动所有服务（推荐） |
| `start-dev.bat` | 交互式启动，适合日常开发 |
| `stop-dev-silent.bat` | 停止所有服务 |

### 使用建议

- **日常开发**: 使用 `start-dev-silent.bat` 启动，使用 `stop-dev-silent.bat` 停止。
- **调试特定服务**: 使用 `start-dev.bat` 启动基础设施，然后在 IDE 中启动需要调试的服务。
- **问题排查**: 使用 `start-dev-debug.bat` 启动，查看详细错误信息。

**Section sources**
- [一键启动.bat](file://一键启动.bat#L1-L231)
- [快速启动.bat](file://快速启动.bat#L1-L143)
- [start-dev-silent.bat](file://start-dev-silent.bat#L1-L316)
- [stop-dev-silent.bat](file://stop-dev-silent.bat#L1-L86)

## 常见问题排查

### 1. 启动脚本闪退

这是最常见的问题，通常由以下原因引起：

- **Docker Desktop 未运行**: 请确保 Docker Desktop 已启动并运行。
- **端口被占用**: 检查端口 `3307`, `6379`, `8848`, `8080-8089`, `5173` 是否被占用。
- **Maven 未安装**: 确保 Maven 已正确安装并配置环境变量。
- **Java 版本不兼容**: 确保使用 JDK 17 或更高版本。

### 2. 端口被占用

使用以下命令检查端口占用情况：

```powershell
netstat -ano | findstr :8080
```

使用以下命令结束占用端口的进程：

```powershell
taskkill /PID <进程ID> /F
```

### 3. 服务启动失败

- **查看日志**: 使用 `pwsh -File tail-logs.ps1 gateway-service` 查看特定服务日志。
- **检查服务状态**: 使用 `pwsh -File check-services-silent.ps1` 检查所有服务状态。
- **重启单个服务**: 使用 `pwsh -File restart-service.ps1 gateway-service` 重启指定服务。

**Section sources**
- [TROUBLESHOOTING.md](file://TROUBLESHOOTING.md#L1-L262)
- [DEVELOPMENT.md](file://DEVELOPMENT.md#L372-L419)

## 服务管理

项目提供一系列 PowerShell 脚本，用于服务管理。

### 1. 检查服务状态

```powershell
pwsh -File check-services-silent.ps1
```

### 2. 查看实时日志

```powershell
# 查看所有服务日志
pwsh -File tail-logs.ps1

# 查看特定服务日志
pwsh -File tail-logs.ps1 user-service
```

### 3. 重启单个服务

```powershell
pwsh -File restart-service.ps1 user-service
```

### 4. 停止所有服务

```bash
stop-dev-silent.bat
```

**Section sources**
- [check-services-silent.ps1](file://check-services-silent.ps1#L1-L257)
- [tail-logs.ps1](file://tail-logs.ps1#L1-L136)
- [restart-service.ps1](file://restart-service.ps1#L1-L212)
- [stop-dev-silent.bat](file://stop-dev-silent.bat#L1-L86)