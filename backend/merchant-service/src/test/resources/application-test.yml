# 测试环境配置
server:
  port: 0  # 随机端口，避免测试时端口冲突

spring:
  application:
    name: merchant-service-test
  datasource:
    # 使用H2内存数据库进行测试
    driver-class-name: org.h2.Driver
    url: jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
    username: sa
    password: 
  jpa:
    hibernate:
      ddl-auto: create-drop  # 测试时每次重新创建表结构
    show-sql: true
    properties:
      hibernate:
        dialect: org.hibernate.dialect.H2Dialect
        format_sql: true
  h2:
    console:
      enabled: true  # 启用H2控制台，方便调试
  redis:
    # 使用嵌入式Redis进行测试
    host: localhost
    port: 6379
    password: 
    database: 1  # 使用不同的数据库避免与开发环境冲突
    timeout: 3000ms

# 禁用服务发现和配置中心（测试环境不需要）
spring.cloud.nacos.discovery.enabled: false
spring.cloud.nacos.config.enabled: false

# 商家配置（测试环境）
merchant:
  audit:
    auto-approve: true   # 测试环境自动审核
    expire-days: 7       # 测试环境缩短过期时间
  commission:
    rate: 0.03           # 测试环境使用较低佣金比例

# 日志配置（测试环境）
logging:
  level:
    com.mall.merchant: debug
    org.springframework.web: debug
    org.hibernate.SQL: debug
    org.hibernate.type.descriptor.sql.BasicBinder: trace
  pattern:
    console: "%clr(%d{HH:mm:ss.SSS}){faint} %clr(${LOG_LEVEL_PATTERN:-%5p}) %clr([%15.15t]){faint} %clr(%-40.40logger{39}){cyan} %clr(:){faint} %m%n"

# 禁用管理端点（测试环境不需要）
management:
  endpoints:
    enabled-by-default: false